---
import type { CollectionEntry } from 'astro:content';
import FormattedDate from '../dates/FormattedDate.astro';
interface Props {
  series: CollectionEntry<'series'>,
  posts: CollectionEntry<'blog'>[]
}

const { series, posts } = Astro.props;
---

<div class="series" style={`--series-bg-image: url(${series.data.imageSummary})`}>
	<div class="series-header">
		<div class="series-title">{series.data.title}</div>
	</div>
	<div class="series-image"></div>
	<div class="series-summary">
	<p>{series.body}
	</div>
	<div class="series-posts">
    {posts.map(p => {
      return <div>
        <span class="post-date"><FormattedDate date={p.data.datePublished} /></span>
        Part {p.data.series!.seriesNumber}, <a class="post-title" href="#">{p.data.title}</a>
      </div>
    })}
			<!-- <div><span class="post-date">4 May 2024</span><a class="post-title" href="#">Part 1, Game Physics Overview</a></div>
			<div><span class="post-date">23 May 2024</span><a class="post-title" href="#">Part 2, Impulses, Rotation, and Numerical Integration</a></div>
			<div><span class="post-date">23 May 2024</span><a class="post-title" href="#">Part 3, Modeling and Solving Constraints</a></div>
			<div><span class="post-date">7 June 2024</span><a class="post-title" href="#">Part 4, Collision Detection: SAT & GJK</a></div>
			<div><span class="post-date">15 June 2024</span><a class="post-title" href="#">Part 5, Contact Generation</a></div>
			<div><span class="post-date">31 June 2024</span><a class="post-title" href="#">Part 6, Sequential Impulse Algorithm</a></div>
			<div><span class="post-date">2 July 2024</span><a class="post-title" href="#">Part 7, Friction Constraints</a></div>
			<div><span class="post-date">2 July 2024</span><a class="post-title" href="#">Part 8, Featherstone Algorithm</a></div> -->
		</ul>
	</div>
</div>
<style>
.series {
	background-color: #e7fff2;
	border-radius: var(--gap-1);
	padding: var(--gap-1);
	margin: var(--gap-1);
}

.series {
	position: relative;
	z-index: 0;
}

.series-posts .post-title {
	display: inline-block;
	font-size: var(--font-size-normal);
	margin-bottom: 0.2em;
}

.series-posts .post-date {
	color: gray;
	display: inline-block;
	width: 8.0em;
	margin-left: 1.0em;
}

.series-image {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	height: 3.5em;

	border-radius: var(--gap-1) var(--gap-1) 0 0;
	z-index: 1;

	mask-image: linear-gradient(to bottom in oklab, rgba(0,0,0,0.4), rgba(0,0,0,0));
	background: var(--series-bg-image), #cfffe5;
	background-blend-mode: multiply, normal;
	background-position: top, top;
	background-repeat: no-repeat;
	background-size: cover;

	user-select: none;
}

.series .series-header {
	z-index: 2;
}

.series .series-title {
	font-size: var(--font-size-post-title);
	font-weight: bold;
	position: relative;
	z-index: 2;
}
</style>