import PostPreview from "@components/content/PostPreview.astro";
import ResumeHeader from "@components/resume/ResumeHeader.astro";
import { getPostUrlBySlug } from "@root/util/query";

<ResumeHeader />

{/* I work as a **research software engineer** for [Hasuo Lab](https://group-mmm.org/~ichiro/) at the <a href="https://www.nii.ac.jp/en/">National Institute of Informatics</a> in Tokyo, where I build software aimed at making formal verification more accessible to engineers working in industry. */}

## Main Interests

* Building reliable, reusable, and maintainable software that is enjoyable to use.
* Working on **language servers**, static analysis, and type inference in order to upgrade the user experience of software engineering workflows.
* Tools for composing **rich text documents**.  I created the [Noteworthy](/projects/noteworthy) markdown editor, as well as the [`prosemirror-math`](/projects/prosemirror-math) and [`remark-cite`](/projects/remark-cite) packages.
* Numerical methods for **graphics** and **simulation**.  I originally learned to code by [making games](/projects/flash-games), and fell in love with the unique confluence of art, math, and code involved.

## Narrative

I thrive in interdisciplinary spaces.  I've never found it easy to categorize myself strictly as frontend/backend, engineer/researcher, high-level/low-level.  I love working on projects that cross traditional boundaries, and value every opportunity to learn something new.

While I find my training in mathematics to be a source of both clarity & delight, math and theory are tools like any other.  Building software is all about choosing the right tools for the job, and I never let mathematical purity get in the way of delivering software that is _useful_ and _maintainable_.

I originally learned to code by making games and uploading them to the Newgrounds game portal.  There, I found a vibrant community of artists, musicians, and programmers with an infectious enthusiasm for game development.  I discovered early on that it's important to _love_ the work that I do.  I try to bring that same enthusiasm to every project I work on.  It's also why I [love teaching](#teaching) and writing.

I believe that *model-building* is the hardest part of software engineering.  Code is *disposable*, in the sense that once everyone agrees on a *model* of the application domain, the *code* itself can be written or re-written rather quickly.

* I believe that **static type systems** are an effective tool for building and communicating *models*.

* I believe that **refactoring** is an essential part of the software engineering process that keeps the *code* up to date with an evolving *model*.  I favor languages which permit *fearless refactoring* through language features such as type systems, parametric polymorphism, referential transparency, and side-effect management.


----

For these reasons, I find that I'm most productive in languages like **TypeScript**, **Haskell**, and **Rust**, which offer strong compile-time guarantees through language features such as powerful type systems, referential transparency, and side-effect management.

I believe that type systems are the most effective way (so far!) to effectively communicate these models among a team.  

and I try to pay that same enthusiasm forward 

Since then, I've always believed that _work can be fun_


I try to bring that same enthusiasm to every project I work on.

I'm always tinkering, both in and outside of my day job.

I believe in open-source software.

I believe *"good enough"* is the enemy of *good*.

I believe that languages like **TypeScript**, **Rust** and **Haskell** help me get it right the _first time_, saving many headaches and much debugging in the future.

* Recently, there's a lot of talk about "fine-tuning" in the context of large language models, but I believe the term also applies naturally to open-source software.  


## Education

* Master of Science (M.S.) in Computer Science from Georgia Institute of Technology, 2019
* Bachelor of Science (B.S.) in Mathematics from University of Michigan, 2017
* See the second page of my resume for a list of notable coursework.

## Publications

[@reimann2024:temporal]

[@mcisaac2016:geospatial]

# Skills

The skills below are listed in no particular order.  Use the links to jump between sections!

* [Product Development](#product-development)
* [Frontend Engineering](#frontend-engineering)
* [Backend Engineering](#backend-engineering)
* [Functional Programming, Compilers, and Formal Methods](#functional-programming-compilers-and-formal-methods)
* [Computer Graphics & Numerical Methods](#computer-graphics--numerical-methods)
* [Machine Learning](#machine-learning)
* [Open Source](#open-source)
* [Teaching](#teaching)

## Product Development

As a **Research & Development Engineer** for [Hasuo Lab](https://group-mmm.org/~ichiro/) at the National Institute of Informatics,

* I worked closely with researchers to help translate their academic work into proof-of-concept software tools aimed at improving **formal verification** workflows in the automotive industry.
* For each project, I considered carefully how best to leverage my team’s core competencies to solve problems brought to us by collaborators from Japanese automotive companies.
* I contributed to the successful delivery of four prototypes:
  * (*ongoing*) A **model checker** for a simple imperative probabilistic programming language. 
  * A domain-specific language called `tempo-lang` which compiles to **signal temporal logic** expressions, along with a **language server** and web app for creating, documenting, and exemplifying specifications. (see [[Reimann 2024]](https://doi.org/10.48550/arXiv.2403.18764))
  * A web app for demonstrating the behavior of RSS safety conditions (see [[Hasuo 2022]](https://arxiv.org/abs/2207.02387))
  * (*joined midway*) A proof checker for Differential Floyd-Hoare Logic (see [[Hasuo 2022]](https://arxiv.org/abs/2207.02387))
* I presented our work at the [IAA Mobility 2023](https://www.iaa-mobility.com/en/visitors/the-iaa-mobility-2023) trade show in Munich, Germany.

<TodoBlock>
Curtis suggestion:  "developing / finding our team's differentiating features..."

core competencies ===? differentiating features?
</TodoBlock>

Many of my [open-source](#open-source) project are aimed at designing better software for students and researchers, whose needs are often underserved by commercial software:

* I created [Noteworthy](https://github.com/benrbray/noteworthy) to experiment with new ways to support WYSIWYG editing of documents making extensive use of math, diagrams, links, and academic citations. 
* I created [`prosemirror-math`](https://github.com/benrbray/prosemirror-math) in order to encourage more widespread adoption of user-friendly LaTeX math input on the web.  With <a href="https://www.npmjs.com/package/@benrbray/prosemirror-math"><img style="display:inline-block; margin: 0; vertical-align: middle; margin-top: -0.15em" src="https://img.shields.io/npm/dw/%40benrbray%2Fprosemirror-math?label=prosemirror-math&labelColor=%23e3e3e3&color=%23b1da9c" alt="~1.8k" /></a> weekly downloads and [adoption](https://forums.zotero.org/discussion/99411/available-for-beta-testing-math-support-in-notes) by the [Zotero](https://www.zotero.org/) reference manager, I like to think that I've already had an impact!

I find it immensely satisfying to work on projects tailored to meet the needs of a niche audience who will benefit directly from my improvements.  A good user experience is at the forefront of all the work that I do.

 {/* and I've honed all the skills listed on this page in service of that goal. */}

## Frontend Engineering

I have 7 years of experience writing **TypeScript**, both professionally and for open source projects.

* I'm proficient with both the **React** and **SolidJS** reactive UI frameworks.
* I have a deep working knowledge of the [**ProseMirror**](https://prosemirror.net/) and [**CodeMirror**](https://codemirror.net/) editor toolkits.
* I've worked briefly with **WebGL** and **Rust+WebAssembly**, and would enjoy diving deeper.

I enjoy designing **rich document editors** for note-taking, documentation, and academic writing.

* I created the [Noteworthy](https://github.com/benrbray/noteworthy) WYSIWYG desktop markdown editor, tailored for personal research notes making extensive use of math and citations.  Built with TypeScript and [Electron](https://www.electronjs.org/).
* I maintain the [`prosemirror-math`](https://github.com/benrbray/prosemirror-math) and [`remark-cite`](https://github.com/benrbray/remark-cite) packages on NPM.


<PreviewGrid columns={2} postSlugs={[
  { slug: "projects/noteworthy", span: 2 },
  { slug: "projects/prosemirror-math", span: 1 },
  { slug: "projects/remark-cite", span: 1 },
]} />

{/* <PostPreview postSlug="frontend/solidjs-vs-react" /> */}

## Backend Engineering

I worked for one year as a **backend engineer** at Smartpay KK, a Japanese fintech startup.

* I led the design, implementation, testing, and release of a programmatic disbursements backend service which integrates with bank APIs to automatically issue merchant payouts and consumer refunds on a fixed schedule.
* I participated in code review, API design, and sprint planning for a backend API powering the mobile & web apps for a pay-later service.
* I collaborated with our frontend team to design a **GraphQL** API to power our mobile app.
* <u>Technologies:</u> Scala (with [`cats-effect`](https://typelevel.org/cats-effect/)), Docker, GCP, Postgres, Terraform Cloud

I also have experience with the following backend tech:

* Building backend services with [`node.js`](https://nodejs.org/en), Scala's [`http4s`](https://http4s.org/), and Haskell's [`servant`](https://hackage.haskell.org/package/servant).
* Containerizing networked applications with **Docker**.
* Writing GitHub Actions for **continuous integration** and other automations.

## Functional Programming, Compilers, and Formal Methods

<TodoBlock>
I work as a **research software engineer** for [Hasuo Lab](https://group-mmm.org/~ichiro/) at the <a href="https://www.nii.ac.jp/en/">National Institute of Informatics</a> in Tokyo, where I build software aimed at making formal methods more accessible to engineers working in industry.
</TodoBlock>

{/* I value the expressiveness and safety that comes with pure, statically-typed functional programming.
Functional programming is a valuable tool (but not the only one!) in my problem-solving toolkit.  
I've been writing Haskell professionally for 2 years.

I value the expressiveness and safety that comes with pure, statically-typed functional programming.  I'm especially interested in working on type systems and language servers.  */}

As a research engineer for Hasuo Lab at NII, I used **Haskell** to develop domain-specific programming languages for formal verification of cyberphysical systems, in collaboration with researchers from Japanese car manufacturers.
  * I worked on a **language server** for `tempo-lang`, a specification language which compiles to [**signal temporal logic**](https://finkbeiner.groups.cispa.de/publications/FFKK22.pdf) expressions.  I also extended the parser and typechecker to support record types, enums, and user-defined functions.
  * I also worked on an **exemplifier** which generates examples of signals which either satisfy or violate the temporal property described by a `tempo-lang` specification.  We achieved this by converting `tempo-lang` expressions into [satisfiability problems](https://en.wikipedia.org/wiki/Satisfiability_modulo_theories), and reconstructing a signal from satisfying assignments found by the [`z3` SMT solver](https://www.microsoft.com/en-us/research/project/z3-3/).
  * You can learn more about our work by reading [this paper](https://doi.org/10.48550/arXiv.2403.18764) or [these slides](https://1drv.ms/b/s!Aj26oQ_Up7Sxg_lcdJOjgBjSL1EzDA?e=bfbg17).

As a backend engineer at Smartpay, I wrote purely-functional **Scala** in tagless-final style using the [`cats-effect`](https://typelevel.org/cats-effect/) ecosystem.  Scala's 

* A [functional core, imperative shell](https://www.destroyallsoftware.com/screencasts/catalog/functional-core-imperative-shell/) architecture enabled us to work quickly, with confidence.

Here are a few related personal projects:

* In my free time, I enjoy working with **dependently-typed** languages like Coq, Idris and Lean.  I created the toy language [`yagi-lang`](https://github.com/benrbray/yagi-lang) to learn more about dependent type theory.
  <PostPreview postSlug="projects/yagi-lang" />

<TodoBlock> 
* Hindley Milner Implementation
* Borscht Music Database
* **TODO:** datalog tagging system
* **TODO:** coalgebraic product construction
* **TODO:** type safari
</TodoBlock>

{/* * I have basic familiarity with the **`coq` proof assistant**, having worked through all the exercises in Volumes 1-3 of the [Software Foundations](https://softwarefoundations.cis.upenn.edu/) book, as well as portions of [CPDT](http://adam.chlipala.net/cpdt/). */}
{/* * I’ve also read through the first 5 chapters of the Homotopy Type Theory:  Univalent Foundations of Mathematics book, to better understand the formal systems that powers proof assistants like Coq. */}
{/* I enjoy reading papers about programming language theory, type systems, formal verification, and category theory in my free time. */}

## Computer Graphics & Numerical Methods

* In my role as a **Computer Vision Engineer** at [EmbodyMe](https://embodyme.com/),
  * spherical harmonics lighting
  * postprocessing graphics pipeline
* I wrote a C++/CUDA simulation of 2D incompressible fluid flow, based on the “Stable Fluids” paper by Jos Stam.  I compared a few different numerical methods, including parallel Jacobi on the GPU and preconditioned conjugate gradient on the CPU.
* I completed graduate courses on computer architecture, compilers, and parallel computing.  My course projects were all written in C++.  Projects for the compilers course involved writing LLVM analysis / transformation passes on LLVM IR.

As a teenager I worked as an independent **game developer**, publishing Flash games to the Newgrounds game portal under the username [archawn](https://archawn.newgrounds.com/games).  My games earned a modest amount of money from ad revenue and sponsorships through the [Flash Games License](https://web.archive.org/web/20130216211457/https://www.fgl.com/) marketplace.  You can play a collection of my early games at the link below.

<PostSummaryFromSlug postSlug="projects/flash-games" show={{ summary: false }} />

## Machine Learning

In my role as a **Computer Vision Engineer** at [EmbodyMe](https://embodyme.com/),

* I improved the quality and performance of our **mouth inpainting** model by 
* I trained deep learning models to transfer facial expressions from one video to another.  I also contributed to graphics the post-processing pipeline; for example, by applying spherical harmonics lighting to the meshes output by our model.
* I maintained our Python/PyTorch codebase (which includes training and visualization code for face-reenactment and inpainting models).
* I led a biweekly deep learning & graphics reading group to follow recent developments (GANs / attention / transformers / distillation / NeRF) and distribute knowledge among the team.

I spent 3 years as an **Undergraduate Research Assistant** using **statistical topic models** to analyze a large corpus of 19th-century German periodicals.  During the course of the project:
  -  I implemented algorithms for topic modeling (LDA/HDP) from scratch in Python.
  - I designed a custom OCR error correction scheme for German blackletter fonts.
  - I trained a logistic regression classifier for place-name detection.
  - I built a web-app allowing humanities researchers to browse our dataset and visualize the results of our topic modeling analysis.


<PostSummaryFromSlug postSlug="projects/dhgp" show={{ summary: false }} />

I have also served as a **lecturer** and **teaching assistant** for a several courses in Machine Learning at the undergraduate & graduate levels.  See the [teaching](#teaching) section below for more details.

## Open Source

### Open Source Packages

I maintain the following `npm` packages:

<PreviewGrid columns={2} postSlugs={[
  { slug: "projects/prosemirror-math", span: 1, show: { image: false } },
  { slug: "projects/remark-cite", span: 1, show: { image: false } },
]} />

### Open Source Contributions

I'm quick to `git clone` open source software that I rely on.  Here are a few of my contributions:

<FancyBox>
(jgm/citeproc#88) [Support hyperlinked titles according to draft of CSL v1.0.2 spec](https://github.com/jgm/citeproc/pull/88)
</FancyBox>

<FancyBox>
(jgm/citeproc#113) [
Address unexpected interaction between CSL `second-field-align` setting and whole-citation links](https://github.com/jgm/citeproc/pull/113)
</FancyBox>

<FancyBox>
(pjones/byline#20) [Support ANSI Vivid Color Intensity](https://github.com/pjones/byline/pull/20)
</FancyBox>

<FancyBox>
(benrbray/tikzjax) my [fork of `aristicat1/tikzjax`](https://github.com/benrbray/tikzjax) adds a `Dockerfile` and fixes build issues
</FancyBox>

<FancyBox>
(beetbox/beets#3692) [Allow Discogs Plugin to respond during Singleton Import Mode](https://github.com/beetbox/beets/pull/3682)
</FancyBox>

## Teaching

Georgia Tech

* (Teaching Assistant) ISYE 6740, Computational Data Analysis, (Spring 2020)
* (**Lecturer/TA**) CS 4540, [Advanced Algorithms for Machine Learning](https://cs4540-f19.github.io/) (Fall 2019)
* (**Lecturer/TA**) CS 4540, [Advanced Algorithms for Machine Learning](https://cs4540-f18.github.io/) (Fall 2018)

University of Michigan

* (Instructional Aide) EECS 445, Machine Learning, (Winter 2017)
* (Instructional Aide) EECS 445, [Machine Learning](https://eecs445-f16.github.io/) (Fall 2016)
* (Instructional Aide) EECS 545, [Graduate Machine Learning](https://github.com/thejakeyboy/umich-eecs545-lectures) (Winter 2016)
* (Math Lab Tutor) MATH 425, Introduction Probability, (Fall 2015 - Winter 2016)


These words [from an interview](https://youtu.be/F572OcpTcKY?t=582) with Brennan Lee Mulligan really capture what teaching means to me:

> When I am with someone who is looking for something that I have, and I can
> give it to them -- the look on someone's face when they *get* it, and it
> becomes *theirs* as well...  
>
> The lighting of a second candle does not diminish the first.  Watching someone
> learn is one of life's greatest joys.  When you're a teacher you have a front
> row seat to learning, which is just -- the most beautiful thing to watch.


{/* I also have a habit of starting reading groups wherever I work!

* At NII, I formed a weekly category theory reading group with each batch of summer interns.
* At EmbodyMe, I led a biweekly deep learning & computer graphics reading group.
* At the University of Michigan, I co-founded [MSAIL](https://msail.github.io/), a student organization aimed at getting undergraduates involved with machine learning research. */}

# Work History

**Research Software Engineer**, National Institute of Informatics

* Used **Haskell** to develop domain-specific programming languages for formal verification of cyberphysical systems.
* My group focused on translating formal methods research into 
* Our work aimed at finding ways to improve the workflow 
* In collaboration with research teams at major Japanese auto manufacturers, Delivered proof-of-concept software too

In collaboration with research teams at 
* Developed `tempo-lang`, a language that compiles to **signal temporal logic** expressions.
  * implemented the parser and typechecker
  * 
* Developed a [model checker](https://en.wikipedia.org/wiki/Model_checking) for a simple imperative probabilistic programming language.
  * 

**Backend Software Engineer**, Smartpay K.K.

**Machine Learning & Graphics Engineer**, EmbodyMe, Inc.

**Research Intern**, RIKEN AIP

* For the Approximate Bayesian Inference team, advised by Emtiyaz Khan

**Research Assistant**, University of Michigan, advised by Peter McIsaac

* Build a **Python** / **flask** web app for humanities researchers to visualize topic models on 19th-century German periodicals.
* Corrected noisy digital scans using a Hidden Markov Model over word fragments.  Trained on a synthetic dataset of eroded digital scans with known text.  Segmented words based on letter-successor-variety.
* Implemented many **statistical inference** algorithms from scratch, including:  Online Variational Inference for LDA and HDP

**Software Engineering Intern**, Microsoft Corporation (Redmond WA, May - Aug 2016)

* Built a multiplatform mobile app with **C#** and **Xamarin** allowing engineers on my team to monitor Windows telemetry data and receive alerts.